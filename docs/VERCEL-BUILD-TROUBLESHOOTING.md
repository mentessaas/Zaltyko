# üîß Troubleshooting de Build en Vercel

## Problemas Comunes y Soluciones

### 1. Error: "pnpm-lock.yaml version mismatch"

**S√≠ntoma:**
```
Detected `pnpm-lock.yaml` version 9 generated by pnpm@10.x with package.json#packageManager pnpm@9.15.3
```

**Soluci√≥n:**

**Opci√≥n A: Regenerar lock file con la versi√≥n correcta**
```bash
# Instalar pnpm 9.15.3
npm install -g pnpm@9.15.3

# Eliminar lock file
rm pnpm-lock.yaml

# Regenerar
pnpm install

# Commit y push
git add pnpm-lock.yaml
git commit -m "fix: Regenerar pnpm-lock.yaml con versi√≥n correcta"
git push
```

**Opci√≥n B: Actualizar package.json a pnpm 10.x**
```bash
# Actualizar packageManager en package.json
# Cambiar: "pnpm@9.15.3+sha512..." 
# A: "pnpm@10.x.x+sha512..."

# Regenerar lock file
rm pnpm-lock.yaml
pnpm install
git add package.json pnpm-lock.yaml
git commit -m "chore: Actualizar a pnpm 10.x"
git push
```

### 2. Error: "Module not found" o "Cannot find module"

**Causa:** Dependencias faltantes o problemas con node_modules

**Soluci√≥n:**
1. Verificar que `package.json` tenga todas las dependencias
2. Asegurarse de que `.vercelignore` no est√© excluyendo archivos necesarios
3. Verificar que `node_modules` no est√© en `.gitignore` (no deber√≠a estar)

### 3. Error: "Build failed" sin detalles

**Soluci√≥n:**
1. Revisar logs completos en Vercel Dashboard
2. Verificar variables de entorno
3. Probar build localmente:
   ```bash
   pnpm install
   pnpm build
   ```

### 4. Error: "Environment variable not found"

**Soluci√≥n:**
1. Ir a Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables
2. Verificar que todas las variables est√©n configuradas
3. Asegurarse de que est√©n disponibles para:
   - ‚úÖ Production
   - ‚úÖ Preview
   - ‚úÖ Development

### 5. Error: "TypeScript errors"

**Soluci√≥n:**
- Verificar `next.config.mjs` tiene `typescript: { ignoreBuildErrors: true }` (ya configurado)
- O corregir los errores de TypeScript

### 6. Error: "Database connection failed"

**Soluci√≥n:**
1. Verificar que `DATABASE_URL` est√© correcta
2. Verificar que la IP de Vercel est√© permitida en Supabase
3. Usar connection pooling si es necesario

### 7. Build lento o timeout

**Soluci√≥n:**
1. Verificar que `.vercelignore` est√© excluyendo archivos innecesarios
2. Optimizar imports
3. Verificar tama√±o del bundle

## Comandos √ötiles

### Probar Build Localmente

```bash
# Instalar dependencias
pnpm install

# Build de producci√≥n
pnpm build

# Verificar que compile
pnpm start
```

### Ver Logs en Vercel

```bash
# Ver logs en tiempo real
vercel logs --follow

# Ver logs de una funci√≥n espec√≠fica
vercel logs --function=api/upload
```

### Verificar Configuraci√≥n

```bash
# Ver configuraci√≥n del proyecto
vercel inspect

# Ver variables de entorno (sin valores)
vercel env ls
```

## Checklist Pre-Build

- [ ] `package.json` tiene todas las dependencias
- [ ] `pnpm-lock.yaml` est√° actualizado
- [ ] `.vercelignore` est√° configurado correctamente
- [ ] `vercel.json` tiene la configuraci√≥n correcta
- [ ] Variables de entorno configuradas en Vercel
- [ ] Build funciona localmente (`pnpm build`)
- [ ] No hay errores de TypeScript cr√≠ticos

## Si el Build Falla

1. **Revisar logs completos** en Vercel Dashboard
2. **Probar localmente** con `pnpm build`
3. **Verificar variables de entorno**
4. **Revisar este documento** para soluciones comunes
5. **Si persiste**, compartir el error completo para diagn√≥stico

